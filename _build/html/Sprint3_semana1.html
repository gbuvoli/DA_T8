
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Sprint 3 : Explorar KPIs con SQL &#8212; Bootcamp Classes</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b76e3c8a" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Sprint3_semana1';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Sprint 3: Explorar KPIs con SQL" href="sp3_intro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/t10logo.png" class="logo__image only-light" alt="Bootcamp Classes - Home"/>
    <script>document.write(`<img src="_static/t10logo.png" class="logo__image only-dark" alt="Bootcamp Classes - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Bienvenidos al mundo de la Anal√≠tica de Datos
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Sp0_postonboarding.html">Sesi√≥n 0 ‚Äî Introducci√≥n y Bienvenida</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="sp1_intro.html">Sprint 1: Introducci√≥n a tu futura profesi√≥n</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="sp1_teo.html">Sprint 1 - Introducci√≥n a tu futura profesi√≥n</a></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="sp2_intro.html">Sprint 2: Transformar datos para insights de negocio</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="Sprint2_semana1.html">Semana 1: Preguntas de Negocio y Preparaci√≥n de Datos</a></li>
<li class="toctree-l2"><a class="reference internal" href="Sprint2_semana2.html">Semana 2: PivotTables, M√©tricas  y Visualizaciones</a></li>


</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="sp3_intro.html">Sprint 3: Explorar KPIs con SQL</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Sprint 3 : Explorar KPIs con SQL</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FSprint3_semana1.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Sprint3_semana1.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Sprint 3 : Explorar KPIs con SQL</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#semana-1">Semana 1</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#entendiendo-el-esquema-relacional">Entendiendo el esquema relacional</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ejercicio-1">üß© Ejercicio 1</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#llaves-primarias-foraneas-y-relaciones">Llaves primarias, for√°neas y relaciones</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ejercicio-2">üß© Ejercicio 2</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conectar-a-la-base-de-datos-y-explorar-tablas-con-sql-simular">Conectar a la base de datos y explorar tablas con SQL (Simular)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#buenas-practicas-para-sql-limpio">Buenas pr√°cticas para SQL limpio</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#select-from-where">SELECT - FROM - WHERE</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#funciones-de-agregacion">FUNCIONES DE AGREGACION</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#group-by-order-by">GROUP BY - ORDER BY</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#where-vs-having">WHERE VS  HAVING</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#case-when">CASE - WHEN</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ejercicio-3">üß© Ejercicio 3</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tipos-de-datos-conversiones">TIPOS DE DATOS: CONVERSIONES</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cierre">Cierre</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sesion-practica">Sesi√≥n Pr√°ctica</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#taller-practico-analitica-de-negocio-con-sql-db-chinook">üß™ Taller pr√°ctico: Anal√≠tica de negocio con SQL (DB Chinook)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#volumen-de-facturas-por-pais">1Ô∏è‚É£ Volumen de facturas por pa√≠s</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ingreso-total-por-pais">2Ô∏è‚É£ Ingreso total por pa√≠s</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ticket-promedio-por-pais">3Ô∏è‚É£ Ticket promedio por pa√≠s</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#paises-con-volumen-significativo-de-facturas">4Ô∏è‚É£ Pa√≠ses con volumen significativo de facturas</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ingresos-por-pais-en-un-rango-de-fechas-between">5Ô∏è‚É£ Ingresos por pa√≠s en un rango de fechas (BETWEEN)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#numero-de-clientes-por-pais">6Ô∏è‚É£ N√∫mero de clientes por pa√≠s</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#clasificacion-de-facturas-por-monto-case-when">7Ô∏è‚É£ Clasificaci√≥n de facturas por monto (CASE WHEN)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cantidad-total-de-items-vendidos-por-factura">8Ô∏è‚É£ Cantidad total de √≠tems vendidos por factura</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#facturas-con-alto-volumen-de-unidades-having">9Ô∏è‚É£ Facturas con alto volumen de unidades (HAVING)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#duracion-total-y-promedio-por-tipo-de-medio">üîü Duraci√≥n total y promedio por tipo de medio</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#siguientes-pasos">Siguientes Pasos</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="sprint-3-explorar-kpis-con-sql">
<h1>Sprint 3 : Explorar KPIs con SQL<a class="headerlink" href="#sprint-3-explorar-kpis-con-sql" title="Link to this heading">#</a></h1>
<section id="semana-1">
<h2>Semana 1<a class="headerlink" href="#semana-1" title="Link to this heading">#</a></h2>
<!-- üîπ SECCI√ìN: EXPLORAR KPIs FINANCIEROS CON SQL üîπ -->
<div style="border-radius: 12px; border: 1px solid #e0e0e0; padding: 20px 24px; font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; background: #fafafa; margin-top: 12px;">
  <!-- ENCABEZADO -->
  <div style="display: flex; flex-wrap: wrap; align-items: center; justify-content: space-between; gap: 12px; margin-bottom: 16px;">
    <div>
      <h2 style="margin: 0 0 4px 0; font-size: 1.5rem;">üìä Explorar KPIs Financieros con SQL</h2>
      <p style="margin: 0; font-size: 0.95rem; color: #374151;">
        C√≥mo usar SQL para analizar m√©tricas financieras desde bases de datos relacionales.
      </p>
    </div>
    <div style="text-align: center;">
      <img src="https://upload.wikimedia.org/wikipedia/commons/8/87/Sql_data_base_with_logo.png" width="160" alt="SQL logo">
      <p style="margin: 6px 0 0 0; font-size: 0.8rem; color: #6b7280;">Imagen de referencia: entorno SQL</p>
    </div>
  </div>
  <!-- DURACI√ìN Y ESTRUCTURA -->
  <div style="background: #fbfcfdff; color: #e5e7eb; border-radius: 10px; padding: 12px 14px; margin-bottom: 18px;">
    <p style="margin: 0 0 8px 0; font-size: 0.95rem;">
      <strong>Duraci√≥n total:</strong> 1h 20 min
    </p>
    <ul style="margin: 0 0 0 18px; font-size: 0.9rem; line-height: 1.6;">
      <li><strong>Parte 1:</strong> Fundamentos de BD relacionales (tablas, PK/FK, ERD).</li>
      <li><strong>Parte 2:</strong> Consultas b√°sicas ‚Äî <code>SELECT</code>, <code>FROM</code>, <code>WHERE</code>, <code>ORDER BY</code>.</li>
      <li><strong>Parte 3:</strong> Agregaciones <code>SUM</code>, <code>AVG</code>, <code>COUNT</code> ‚Äî agrupaciones <code>GROUP BY</code>, condiciones <code>CASE WHEN</code>, <code>BETWEEN</code>, <code>OR</code>, <code>AND</code>, <code>IN</code>, cortes por fecha.</li>
      <li><strong>Parte 4:</strong> Detecci√≥n de problemas de calidad de datos (valores nulos, duplicados) con <code>IS NOT NULL</code>, <code>DISTINCT</code>.</li>
      <li><strong>Parte 5:</strong> Buenas pr√°cticas + precisi√≥n con tipos de datos: <code>CAST</code>, <code>ROUND</code>, comentarios.</li>
    </ul>
  </div>
  <!-- OBJETIVOS DE APRENDIZAJE -->
  <div style="background: white; border-radius: 10px; padding: 14px 16px; border: 1px solid #e5e7eb; margin-bottom: 4px;">
    <h3 style="margin-top: 0; font-size: 1.15rem;">üéØ Objetivos de aprendizaje</h3>
    <ul style="margin: 6px 0 0 18px; font-size: 0.95rem; line-height: 1.6;">
      <li>Entender la estructura de una base de datos relacional y su esquema.</li>
      <li>Identificar llaves primarias (PK) y for√°neas (FK) y su rol en el modelo.</li>
      <li>Ejecutar consultas b√°sicas para explorar, filtrar, ordenar y agrupar datos.</li>
      <li>Aplicar funciones de fecha y num√©ricas para calcular KPIs financieros.</li>
      <li>Detectar problemas de calidad de datos (nulos, duplicados) durante la exploraci√≥n.</li>
    </ul>
  </div>
</div>
<!-- üîπ INTRO SQL - BLOQUE EDUCATIVO EN HTML PARA MARKDOWN üîπ -->
<div style="border-radius: 12px; border: 1px solid #e0e0e0; padding: 20px 24px; font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; background: #fafafa;">
  <!-- T√çTULO PRINCIPAL -->
  <div style="background: linear-gradient(90deg, #2563eb, #22c55e); border-radius: 10px; padding: 16px 20px; color: white; margin-bottom: 18px;">
    <h2 style="margin: 0; font-size: 1.5rem; display: flex; align-items: center; gap: 8px;">
      üß† Introducci√≥n a SQL (Structured Query Language)
    </h2>
    <p style="margin: 6px 0 0 0; font-size: 0.95rem; opacity: 0.9;">
      Material de apoyo para la clase ‚Äì lectura r√°pida y visual para entender qu√© es SQL y por qu√© importa.
    </p>
  </div>
  <!-- DEFINICI√ìN BASES DE DATOS + SQL -->
  <div style="display: flex; flex-wrap: wrap; gap: 12px; margin-bottom: 16px;">
    <div style="flex: 1 1 260px; background: white; border-radius: 10px; padding: 14px 16px; border: 1px solid #e5e7eb;">
      <h3 style="margin-top: 0; font-size: 1.05rem;">üìö ¬øQu√© es una base de datos relacional?</h3>
      <p style="margin: 0; font-size: 0.95rem; line-height: 1.4;">
        Una <strong>base de datos relacional</strong> es un sistema estructurado donde los datos se almacenan en
        <strong>tablas conectadas entre s√≠</strong> mediante claves, lo que permite consultar, combinar y mantener
        la informaci√≥n de forma coherente usando <strong>SQL</strong>.
      </p>
    </div>
  <div style="flex: 1 1 260px; background: white; border-radius: 10px; padding: 14px 16px; border: 1px solid #e5e7eb;">
      <h3 style="margin-top: 0; font-size: 1.05rem;">üíª ¬øQu√© es SQL?</h3>
      <p style="margin: 0; font-size: 0.95rem; line-height: 1.4;">
        <strong>SQL</strong> es el lenguaje est√°ndar para <strong>consultar, modificar y analizar</strong> datos
        en bases de datos relacionales como <strong>PostgreSQL</strong>, <strong>MySQL</strong> o
        <strong>SQL Server</strong>.
      </p>
      <p style="margin: 8px 0 0 0; font-size: 0.9rem; line-height: 1.4;">
        Es un <strong>lenguaje declarativo</strong>: describes <em>qu√©</em> informaci√≥n necesitas y el motor decide
        <em>c√≥mo</em> obtenerla.
      </p>
    </div>
  </div>
  <!-- EJEMPLO DE CONSULTA -->
  <div style="background: #0f172a; color: #e5e7eb; border-radius: 10px; padding: 14px 16px; margin-bottom: 18px; font-family: 'JetBrains Mono', 'Fira Code', monospace;">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px;">
      <span style="font-size: 0.95rem;">üîé Ejemplo simple de consulta SQL</span>
      <span style="font-size: 0.75rem; opacity: 0.7;">tabla: <code>books</code></span>
    </div>
    <pre style="margin: 0; font-size: 0.9rem; overflow-x: auto;"><code class="language-sql">SELECT title, num_pages
FROM books
WHERE num_pages &gt; 300;</code></pre>
  </div>
  <!-- C√ìMO FUNCIONA UNA CONSULTA -->
  <div style="background: white; border-radius: 10px; padding: 14px 16px; border: 1px solid #e5e7eb; margin-bottom: 18px;">
    <h3 style="margin-top: 0; font-size: 1.05rem;">‚öôÔ∏è ¬øC√≥mo funciona una consulta SQL?</h3>
    <ol style="margin: 6px 0 0 18px; font-size: 0.95rem; line-height: 1.5;">
      <li>El cliente (Jupyter, IDE, BI, etc.) env√≠a la consulta al servidor.</li>
      <li>El motor SQL la analiza, valida la sintaxis y los permisos.</li>
      <li>El <strong>optimizador</strong> elige el plan de ejecuci√≥n (uso de √≠ndices, joins, etc.).</li>
      <li>Se ejecuta el plan y se retorna un <strong>conjunto de filas y columnas</strong> como resultado.</li>
    </ol>
  </div>
  <!-- √ÅMBITOS DE USO -->
  <div style="display: flex; flex-wrap: wrap; gap: 12px; margin-bottom: 18px;">
    <div style="flex: 1 1 260px; background: #f1f5f9; border-radius: 10px; padding: 12px 14px;">
      <h3 style="margin-top: 0; font-size: 1.05rem;">üåé ¬øEn qu√© √°mbitos se usa SQL?</h3>
      <ul style="margin: 6px 0 0 18px; font-size: 0.95rem; line-height: 1.5;">
        <li><strong>Data Analyst:</strong> extraer, limpiar y resumir datos para KPIs y dashboards.</li>
        <li><strong>Data Scientist:</strong> preparar datasets para modelos y experimentos.</li>
        <li><strong>Data Engineer:</strong> construir pipelines sobre RDBMS (sistemas de bases relacionales).</li>
        <li><strong>BI / Producto / Finanzas:</strong> consultas directas para m√©tricas de negocio.</li>
      </ul>
    </div>
    <div style="flex: 1 1 260px; background: #ecfdf5; border-radius: 10px; padding: 12px 14px;">
      <h3 style="margin-top: 0; font-size: 1.05rem;">üí∞ Ejemplos t√≠picos en negocio y finanzas</h3>
      <ul style="margin: 6px 0 0 18px; font-size: 0.95rem; line-height: 1.5;">
        <li>Ingresos, costos y m√°rgenes.</li>
        <li>Ticket promedio por cliente o transacci√≥n.</li>
        <li>Tendencias temporales por d√≠a, semana o mes.</li>
        <li>An√°lisis de cohortes y comportamiento de usuarios en el tiempo.</li>
      </ul>
    </div>
  </div>
  <!-- COMANDOS FUNDAMENTALES -->
  <div style="background: white; border-radius: 10px; padding: 14px 16px; border: 1px solid #e5e7eb; margin-bottom: 18px;">
    <h3 style="margin-top: 0; font-size: 1.05rem;">üß© Comandos fundamentales de SQL</h3>
    <p style="margin: 4px 0 8px 0; font-size: 0.95rem;">Los bloques que usar√°s todo el tiempo:</p>
    <div style="display: flex; flex-wrap: wrap; gap: 8px; font-size: 0.9rem;">
      <span style="background: #eff6ff; padding: 4px 8px; border-radius: 999px;"><code>SELECT</code> ‚Üí leer datos</span>
      <span style="background: #fef9c3; padding: 4px 8px; border-radius: 999px;"><code>WHERE</code> ‚Üí filtros</span>
      <span style="background: #f5f3ff; padding: 4px 8px; border-radius: 999px;"><code>ORDER BY</code> ‚Üí ordenar</span>
      <span style="background: #ecfeff; padding: 4px 8px; border-radius: 999px;"><code>GROUP BY</code> / <code>HAVING</code> ‚Üí agregaciones</span>
      <span style="background: #fef2f2; padding: 4px 8px; border-radius: 999px;"><code>JOIN</code> ‚Üí unir tablas</span>
      <span style="background: #f0fdf4; padding: 4px 8px; border-radius: 999px;"><code>COUNT</code>, <code>AVG</code>, <code>SUM</code>, <code>ROUND</code> ‚Üí funciones</span>
      <span style="background: #e0f2fe; padding: 4px 8px; border-radius: 999px;">subconsultas (subqueries)</span>
    </div>
  </div>
  <!-- IMPORTANCIA PARA DATA ANALYST -->
  <div style="background: #abc3f8ff; color: #e5e7eb; border-radius: 10px; padding: 14px 16px; margin-bottom: 18px;">
    <h3 style="margin-top: 0; font-size: 1.05rem;">üéØ Importancia de SQL para un Data Analyst</h3>
    <ul style="margin: 6px 0 0 18px; font-size: 0.95rem; line-height: 1.5;">
      <li>Permite <strong>acceso directo</strong> a los datos desde la fuente.</li>
      <li>Respuestas r√°pidas sin necesidad de procesos ETL complejos.</li>
      <li>Posibilidad de definir <strong>KPIs reproducibles</strong> y auditables.</li>
      <li>Base s√≥lida para integrarte con Python, R, BI y otros entornos.</li>
    </ul>
    <p style="margin: 10px 0 0 0; font-size: 0.9rem;">
      <strong>Flujo t√≠pico de trabajo:</strong> <code>SQL ‚Üí (opcional) Pandas ‚Üí Visualizaci√≥n (BI / Notebook)</code>
    </p>
  </div>
  <!-- TIPS INICIALES -->
  <div style="background: #f9fafb; border-radius: 10px; padding: 14px 16px; border: 1px solid #e5e7eb;">
    <h3 style="margin-top: 0; font-size: 1.05rem;">üí° Tips iniciales para escribir buen SQL</h3>
    <ol style="margin: 6px 0 0 18px; font-size: 0.95rem; line-height: 1.6;">
      <li>Empieza simple y <strong>valida tus filtros</strong> antes de unir o agrupar.</li>
      <li>Comenta tu c√≥digo SQL y usa <strong>alias claros</strong> con <code>AS</code>.</li>
      <li>Evita <code>SELECT *</code> en producci√≥n; <strong>especifica siempre las columnas</strong>.</li>
      <li>Usa <code>LIMIT</code> cuando est√©s explorando datos.</li>
      <li>Formatea e indenta tus consultas para facilitar lectura y mantenimiento.</li>
    </ol>
  </div>
</div>
</section>
<section id="entendiendo-el-esquema-relacional">
<h2>Entendiendo el esquema relacional<a class="headerlink" href="#entendiendo-el-esquema-relacional" title="Link to this heading">#</a></h2>
<p><img alt="Esquema" src="_images/chinook_esquema.png" /></p>
<section id="ejercicio-1">
<h3>üß© Ejercicio 1<a class="headerlink" href="#ejercicio-1" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>¬øQu√© preguntas de negocio podr√≠as responder con este esquema? (p. ej., <em>promedio de facturacion por genero musical</em>, <em>cantidad de albumes por artista</em>, <em>evoluci√≥n anual de las ventas por album</em>).</p></li>
</ul>
</section>
</section>
<section id="llaves-primarias-foraneas-y-relaciones">
<h2>Llaves primarias, for√°neas y relaciones<a class="headerlink" href="#llaves-primarias-foraneas-y-relaciones" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>PK (Primary Key):</strong> asegura unicidad por fila (ej. <code class="docutils literal notranslate"><span class="pre">Artist.Artist_id</span></code>).</p></li>
<li><p><strong>FK (Foreign Key):</strong> referencia a otra tabla (ej. <code class="docutils literal notranslate"><span class="pre">Album.Artist_id</span></code> ‚Üí <code class="docutils literal notranslate"><span class="pre">Artist.Artist_id</span></code>).</p></li>
</ul>
<p>Estas llaves articulan el modelo relacional y permiten combinar informaci√≥n de diferentes tablas.</p>
<section id="ejercicio-2">
<h3>üß© Ejercicio 2<a class="headerlink" href="#ejercicio-2" title="Link to this heading">#</a></h3>
<p>Marca (en papel o mentalmente) las relaciones entre <code class="docutils literal notranslate"><span class="pre">Tracks</span></code>, <code class="docutils literal notranslate"><span class="pre">Albums</span></code>, <code class="docutils literal notranslate"><span class="pre">Artists</span></code>, <code class="docutils literal notranslate"><span class="pre">Invoices</span></code> e <code class="docutils literal notranslate"><span class="pre">InvoiceLines</span></code>.</p>
<blockquote>
<div><p>Piensa c√≥mo combinar√≠as tablas para responder a: ‚Äú¬øQu√© artista vende pistas con mayor ingreso promedio (promedio de UnitPrice * Quantity por track)?‚Äù</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Paso 1: Descargar el archivo desde GitHub</span>
<span class="o">!</span>curl<span class="w"> </span>-L<span class="w"> </span>-o<span class="w"> </span>chinook.db<span class="w"> </span>https://github.com/lerocha/chinook-database/raw/master/ChinookDatabase/DataSources/Chinook_Sqlite.sqlite


<span class="c1"># Paso 2: Instalar ipython-sql si no est√° instalada</span>
<span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>-q<span class="w"> </span>ipython-sql

<span class="c1"># Paso 3: Cargar extensi√≥n y conectar a la base</span>
<span class="o">%</span><span class="k">load_ext</span> sql
<span class="o">%</span><span class="k">config</span> SqlMagic.style = &#39;PLAIN_COLUMNS&#39;
<span class="o">%</span><span class="k">sql</span> sqlite:///chinook.db
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed

  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0

  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
100  984k  100  984k    0     0  1003k      0 --:--:-- --:--:-- --:--:-- 1839k
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sqlite3</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Hacemos la conexi√≥n a la Database</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;chinook.db&quot;</span><span class="p">)</span>

<span class="c1"># Redactamos la Query</span>
<span class="n">query</span><span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">SELECT name</span>
<span class="s1">FROM sqlite_master</span>
<span class="s1">WHERE type=&#39;table&#39;;</span>
<span class="s1">&#39;&#39;&#39;</span>
<span class="c1">#Consultamos e imprimimos resultado</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Album</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Artist</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Customer</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Employee</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Genre</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Invoice</td>
    </tr>
    <tr>
      <th>6</th>
      <td>InvoiceLine</td>
    </tr>
    <tr>
      <th>7</th>
      <td>MediaType</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Playlist</td>
    </tr>
    <tr>
      <th>9</th>
      <td>PlaylistTrack</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Track</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="conectar-a-la-base-de-datos-y-explorar-tablas-con-sql-simular">
<h2>Conectar a la base de datos y explorar tablas con SQL (Simular)<a class="headerlink" href="#conectar-a-la-base-de-datos-y-explorar-tablas-con-sql-simular" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>1: Descarga la database <a class="reference external" href="https://github.com/lerocha/chinook-database/raw/master/ChinookDatabase/DataSources/Chinook_Sqlite.sqlite">Chinook</a></p></li>
<li><p>Visita: Sqlite online to open the database and run queries.   <a class="reference external" href="https://sqliteonline.com/">SqliteOnline</a></p></li>
<li><p>Carga la base de datos y ejecuta la siguiente consulta para inspeccionar la tabla <code class="docutils literal notranslate"><span class="pre">tracks</span></code>:</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="n">SELECT</span> <span class="o">*</span>
 <span class="n">FROM</span> <span class="n">tracks</span>
 <span class="n">LIMIT</span> <span class="mi">10</span><span class="p">;</span>
</pre></div>
</div>
<p><strong>Observa:</strong> tipos de datos, rangos, valores faltantes o at√≠picos.</p>
<blockquote>
<div><p>¬øQu√© columnas pueden servir como KPIs?</p>
</div></blockquote>
<ul class="simple">
<li><p>UnitPrice ‚Üí valor base de cada pista (precio de cat√°logo).</p></li>
<li><p>Milliseconds ‚Üí duraci√≥n; sirve como feature de contenido.</p></li>
<li><p>Bytes ‚Üí tama√±o del archivo; otra dimensi√≥n t√©cnica.</p></li>
</ul>
<section id="buenas-practicas-para-sql-limpio">
<h3>Buenas pr√°cticas para SQL limpio<a class="headerlink" href="#buenas-practicas-para-sql-limpio" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Palabras clave en <strong>MAY√öSCULAS</strong> (<code class="docutils literal notranslate"><span class="pre">SELECT</span></code>, <code class="docutils literal notranslate"><span class="pre">WHERE</span></code>, <code class="docutils literal notranslate"><span class="pre">GROUP</span> <span class="pre">BY</span></code>).</p></li>
<li><p>Indentaci√≥n consistente (una operaci√≥n por l√≠nea).</p></li>
<li><p>Alias claros (<code class="docutils literal notranslate"><span class="pre">AS</span></code>) y comentarios para l√≥gica compleja.</p></li>
<li><p>Usa <code class="docutils literal notranslate"><span class="pre">LIMIT</span></code> en exploraci√≥n para controlar tiempos.</p></li>
<li><p>Evita <code class="docutils literal notranslate"><span class="pre">SELECT</span> <span class="pre">*</span></code> en producci√≥n; especifica columnas.</p></li>
<li><p>Nombres de columnas y tablas coherentes y expresivos.</p></li>
</ul>
</section>
</section>
<section id="select-from-where">
<h2>SELECT - FROM - WHERE<a class="headerlink" href="#select-from-where" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Podemos indicar una o varios campos que queremos consultar</span>

<span class="n">query</span><span class="o">=</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">SELECT ArtistId, Title</span>
<span class="s1">FROM Album;</span>
<span class="s1">&#39;&#39;&#39;</span>


<span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ArtistId</th>
      <th>Title</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>For Those About To Rock We Salute You</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Balls to the Wall</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>Restless and Wild</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>Let There Be Rock</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3</td>
      <td>Big Ones</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>342</th>
      <td>226</td>
      <td>Respighi:Pines of Rome</td>
    </tr>
    <tr>
      <th>343</th>
      <td>272</td>
      <td>Schubert: The Late String Quartets &amp; String Qu...</td>
    </tr>
    <tr>
      <th>344</th>
      <td>273</td>
      <td>Monteverdi: L'Orfeo</td>
    </tr>
    <tr>
      <th>345</th>
      <td>274</td>
      <td>Mozart: Chamber Music</td>
    </tr>
    <tr>
      <th>346</th>
      <td>275</td>
      <td>Koyaanisqatsi (Soundtrack from the Motion Pict...</td>
    </tr>
  </tbody>
</table>
<p>347 rows √ó 2 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query</span><span class="o">=</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">SELECT FirstName,LastName,City FROM Employee;</span>
<span class="s1">&#39;&#39;&#39;</span>

<span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>FirstName</th>
      <th>LastName</th>
      <th>City</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Andrew</td>
      <td>Adams</td>
      <td>Edmonton</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Nancy</td>
      <td>Edwards</td>
      <td>Calgary</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jane</td>
      <td>Peacock</td>
      <td>Calgary</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Margaret</td>
      <td>Park</td>
      <td>Calgary</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Steve</td>
      <td>Johnson</td>
      <td>Calgary</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Michael</td>
      <td>Mitchell</td>
      <td>Calgary</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Robert</td>
      <td>King</td>
      <td>Lethbridge</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Laura</td>
      <td>Callahan</td>
      <td>Lethbridge</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>Mostrar los nombres y pa√≠ses de los clientes de Brasil</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query</span><span class="o">=</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">SELECT FirstName, LastName, city</span>
<span class="s1">FROM Customer</span>
<span class="s1">WHERE Country = &#39;Brazil&#39;;</span>
<span class="s1">&#39;&#39;&#39;</span>

<span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>FirstName</th>
      <th>LastName</th>
      <th>City</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Lu√≠s</td>
      <td>Gon√ßalves</td>
      <td>S√£o Jos√© dos Campos</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Eduardo</td>
      <td>Martins</td>
      <td>S√£o Paulo</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Alexandre</td>
      <td>Rocha</td>
      <td>S√£o Paulo</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Roberto</td>
      <td>Almeida</td>
      <td>Rio de Janeiro</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Fernanda</td>
      <td>Ramos</td>
      <td>Bras√≠lia</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>Clientes de Canad√° o Alemania</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query</span><span class="o">=</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">SELECT FirstName, LastName, City, Country</span>
<span class="s1">FROM Customer</span>
<span class="s1">WHERE Country = &#39;Canada&#39; OR Country = &#39;Germany&#39;;</span>
<span class="s1">&#39;&#39;&#39;</span>

<span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>FirstName</th>
      <th>LastName</th>
      <th>City</th>
      <th>Country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Leonie</td>
      <td>K√∂hler</td>
      <td>Stuttgart</td>
      <td>Germany</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Fran√ßois</td>
      <td>Tremblay</td>
      <td>Montr√©al</td>
      <td>Canada</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Mark</td>
      <td>Philips</td>
      <td>Edmonton</td>
      <td>Canada</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Jennifer</td>
      <td>Peterson</td>
      <td>Vancouver</td>
      <td>Canada</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Robert</td>
      <td>Brown</td>
      <td>Toronto</td>
      <td>Canada</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Edward</td>
      <td>Francis</td>
      <td>Ottawa</td>
      <td>Canada</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Martha</td>
      <td>Silk</td>
      <td>Halifax</td>
      <td>Canada</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Aaron</td>
      <td>Mitchell</td>
      <td>Winnipeg</td>
      <td>Canada</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Ellie</td>
      <td>Sullivan</td>
      <td>Yellowknife</td>
      <td>Canada</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Hannah</td>
      <td>Schneider</td>
      <td>Berlin</td>
      <td>Germany</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Fynn</td>
      <td>Zimmermann</td>
      <td>Frankfurt</td>
      <td>Germany</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Niklas</td>
      <td>Schr√∂der</td>
      <td>Berlin</td>
      <td>Germany</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>Clientes del estado de California</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query</span><span class="o">=</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">SELECT CustomerId,FirstName,City</span>
<span class="s1">FROM Customer</span>
<span class="s1">WHERE State=&#39;CA&#39;;</span>
<span class="s1">&#39;&#39;&#39;</span>

<span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CustomerId</th>
      <th>FirstName</th>
      <th>City</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>16</td>
      <td>Frank</td>
      <td>Mountain View</td>
    </tr>
    <tr>
      <th>1</th>
      <td>19</td>
      <td>Tim</td>
      <td>Cupertino</td>
    </tr>
    <tr>
      <th>2</th>
      <td>20</td>
      <td>Dan</td>
      <td>Mountain View</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>Clientes que no vivan en USA</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query</span><span class="o">=</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">SELECT FirstName, LastName, City, Country</span>
<span class="s1">FROM Customer</span>
<span class="s1">WHERE Country != &quot;USA&quot;;</span>
<span class="s1">&#39;&#39;&#39;</span>

<span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>FirstName</th>
      <th>LastName</th>
      <th>City</th>
      <th>Country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Lu√≠s</td>
      <td>Gon√ßalves</td>
      <td>S√£o Jos√© dos Campos</td>
      <td>Brazil</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Leonie</td>
      <td>K√∂hler</td>
      <td>Stuttgart</td>
      <td>Germany</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Fran√ßois</td>
      <td>Tremblay</td>
      <td>Montr√©al</td>
      <td>Canada</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Bj√∏rn</td>
      <td>Hansen</td>
      <td>Oslo</td>
      <td>Norway</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Franti≈°ek</td>
      <td>Wichterlov√°</td>
      <td>Prague</td>
      <td>Czech Republic</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Helena</td>
      <td>Hol√Ω</td>
      <td>Prague</td>
      <td>Czech Republic</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Astrid</td>
      <td>Gruber</td>
      <td>Vienne</td>
      <td>Austria</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Daan</td>
      <td>Peeters</td>
      <td>Brussels</td>
      <td>Belgium</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Kara</td>
      <td>Nielsen</td>
      <td>Copenhagen</td>
      <td>Denmark</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Eduardo</td>
      <td>Martins</td>
      <td>S√£o Paulo</td>
      <td>Brazil</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Alexandre</td>
      <td>Rocha</td>
      <td>S√£o Paulo</td>
      <td>Brazil</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Roberto</td>
      <td>Almeida</td>
      <td>Rio de Janeiro</td>
      <td>Brazil</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Fernanda</td>
      <td>Ramos</td>
      <td>Bras√≠lia</td>
      <td>Brazil</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Mark</td>
      <td>Philips</td>
      <td>Edmonton</td>
      <td>Canada</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Jennifer</td>
      <td>Peterson</td>
      <td>Vancouver</td>
      <td>Canada</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Robert</td>
      <td>Brown</td>
      <td>Toronto</td>
      <td>Canada</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Edward</td>
      <td>Francis</td>
      <td>Ottawa</td>
      <td>Canada</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Martha</td>
      <td>Silk</td>
      <td>Halifax</td>
      <td>Canada</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Aaron</td>
      <td>Mitchell</td>
      <td>Winnipeg</td>
      <td>Canada</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Ellie</td>
      <td>Sullivan</td>
      <td>Yellowknife</td>
      <td>Canada</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Jo√£o</td>
      <td>Fernandes</td>
      <td>Lisbon</td>
      <td>Portugal</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Madalena</td>
      <td>Sampaio</td>
      <td>Porto</td>
      <td>Portugal</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Hannah</td>
      <td>Schneider</td>
      <td>Berlin</td>
      <td>Germany</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Fynn</td>
      <td>Zimmermann</td>
      <td>Frankfurt</td>
      <td>Germany</td>
    </tr>
    <tr>
      <th>24</th>
      <td>Niklas</td>
      <td>Schr√∂der</td>
      <td>Berlin</td>
      <td>Germany</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Camille</td>
      <td>Bernard</td>
      <td>Paris</td>
      <td>France</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Dominique</td>
      <td>Lefebvre</td>
      <td>Paris</td>
      <td>France</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Marc</td>
      <td>Dubois</td>
      <td>Lyon</td>
      <td>France</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Wyatt</td>
      <td>Girard</td>
      <td>Bordeaux</td>
      <td>France</td>
    </tr>
    <tr>
      <th>29</th>
      <td>Isabelle</td>
      <td>Mercier</td>
      <td>Dijon</td>
      <td>France</td>
    </tr>
    <tr>
      <th>30</th>
      <td>Terhi</td>
      <td>H√§m√§l√§inen</td>
      <td>Helsinki</td>
      <td>Finland</td>
    </tr>
    <tr>
      <th>31</th>
      <td>Ladislav</td>
      <td>Kov√°cs</td>
      <td>Budapest</td>
      <td>Hungary</td>
    </tr>
    <tr>
      <th>32</th>
      <td>Hugh</td>
      <td>O'Reilly</td>
      <td>Dublin</td>
      <td>Ireland</td>
    </tr>
    <tr>
      <th>33</th>
      <td>Lucas</td>
      <td>Mancini</td>
      <td>Rome</td>
      <td>Italy</td>
    </tr>
    <tr>
      <th>34</th>
      <td>Johannes</td>
      <td>Van der Berg</td>
      <td>Amsterdam</td>
      <td>Netherlands</td>
    </tr>
    <tr>
      <th>35</th>
      <td>Stanis≈Çaw</td>
      <td>W√≥jcik</td>
      <td>Warsaw</td>
      <td>Poland</td>
    </tr>
    <tr>
      <th>36</th>
      <td>Enrique</td>
      <td>Mu√±oz</td>
      <td>Madrid</td>
      <td>Spain</td>
    </tr>
    <tr>
      <th>37</th>
      <td>Joakim</td>
      <td>Johansson</td>
      <td>Stockholm</td>
      <td>Sweden</td>
    </tr>
    <tr>
      <th>38</th>
      <td>Emma</td>
      <td>Jones</td>
      <td>London</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>39</th>
      <td>Phil</td>
      <td>Hughes</td>
      <td>London</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>40</th>
      <td>Steve</td>
      <td>Murray</td>
      <td>Edinburgh</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>41</th>
      <td>Mark</td>
      <td>Taylor</td>
      <td>Sidney</td>
      <td>Australia</td>
    </tr>
    <tr>
      <th>42</th>
      <td>Diego</td>
      <td>Guti√©rrez</td>
      <td>Buenos Aires</td>
      <td>Argentina</td>
    </tr>
    <tr>
      <th>43</th>
      <td>Luis</td>
      <td>Rojas</td>
      <td>Santiago</td>
      <td>Chile</td>
    </tr>
    <tr>
      <th>44</th>
      <td>Manoj</td>
      <td>Pareek</td>
      <td>Delhi</td>
      <td>India</td>
    </tr>
    <tr>
      <th>45</th>
      <td>Puja</td>
      <td>Srivastava</td>
      <td>Bangalore</td>
      <td>India</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>Facturas (Invoice) con montos totales entre 10 y 20 USD</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query</span><span class="o">=</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">SELECT InvoiceId, CustomerId, Total</span>
<span class="s1">FROM Invoice</span>
<span class="s1">WHERE Total BETWEEN 10 AND 20;</span>
<span class="s1">&#39;&#39;&#39;</span>

<span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>InvoiceId</th>
      <th>CustomerId</th>
      <th>Total</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5</td>
      <td>23</td>
      <td>13.86</td>
    </tr>
    <tr>
      <th>1</th>
      <td>12</td>
      <td>2</td>
      <td>13.86</td>
    </tr>
    <tr>
      <th>2</th>
      <td>19</td>
      <td>40</td>
      <td>13.86</td>
    </tr>
    <tr>
      <th>3</th>
      <td>26</td>
      <td>19</td>
      <td>13.86</td>
    </tr>
    <tr>
      <th>4</th>
      <td>33</td>
      <td>57</td>
      <td>13.86</td>
    </tr>
    <tr>
      <th>5</th>
      <td>40</td>
      <td>36</td>
      <td>13.86</td>
    </tr>
    <tr>
      <th>6</th>
      <td>47</td>
      <td>15</td>
      <td>13.86</td>
    </tr>
    <tr>
      <th>7</th>
      <td>54</td>
      <td>53</td>
      <td>13.86</td>
    </tr>
    <tr>
      <th>8</th>
      <td>61</td>
      <td>32</td>
      <td>13.86</td>
    </tr>
    <tr>
      <th>9</th>
      <td>68</td>
      <td>11</td>
      <td>13.86</td>
    </tr>
    <tr>
      <th>10</th>
      <td>75</td>
      <td>49</td>
      <td>13.86</td>
    </tr>
    <tr>
      <th>11</th>
      <td>82</td>
      <td>28</td>
      <td>13.86</td>
    </tr>
    <tr>
      <th>12</th>
      <td>88</td>
      <td>57</td>
      <td>17.91</td>
    </tr>
    <tr>
      <th>13</th>
      <td>89</td>
      <td>7</td>
      <td>18.86</td>
    </tr>
    <tr>
      <th>14</th>
      <td>103</td>
      <td>24</td>
      <td>15.86</td>
    </tr>
    <tr>
      <th>15</th>
      <td>110</td>
      <td>3</td>
      <td>13.86</td>
    </tr>
    <tr>
      <th>16</th>
      <td>117</td>
      <td>41</td>
      <td>13.86</td>
    </tr>
    <tr>
      <th>17</th>
      <td>124</td>
      <td>20</td>
      <td>13.86</td>
    </tr>
    <tr>
      <th>18</th>
      <td>131</td>
      <td>58</td>
      <td>13.86</td>
    </tr>
    <tr>
      <th>19</th>
      <td>138</td>
      <td>37</td>
      <td>13.86</td>
    </tr>
    <tr>
      <th>20</th>
      <td>145</td>
      <td>16</td>
      <td>13.86</td>
    </tr>
    <tr>
      <th>21</th>
      <td>152</td>
      <td>54</td>
      <td>13.86</td>
    </tr>
    <tr>
      <th>22</th>
      <td>159</td>
      <td>33</td>
      <td>13.86</td>
    </tr>
    <tr>
      <th>23</th>
      <td>166</td>
      <td>12</td>
      <td>13.86</td>
    </tr>
    <tr>
      <th>24</th>
      <td>173</td>
      <td>50</td>
      <td>13.86</td>
    </tr>
    <tr>
      <th>25</th>
      <td>180</td>
      <td>29</td>
      <td>13.86</td>
    </tr>
    <tr>
      <th>26</th>
      <td>187</td>
      <td>8</td>
      <td>13.86</td>
    </tr>
    <tr>
      <th>27</th>
      <td>193</td>
      <td>37</td>
      <td>14.91</td>
    </tr>
    <tr>
      <th>28</th>
      <td>201</td>
      <td>25</td>
      <td>18.86</td>
    </tr>
    <tr>
      <th>29</th>
      <td>208</td>
      <td>4</td>
      <td>15.86</td>
    </tr>
    <tr>
      <th>30</th>
      <td>215</td>
      <td>42</td>
      <td>13.86</td>
    </tr>
    <tr>
      <th>31</th>
      <td>222</td>
      <td>21</td>
      <td>13.86</td>
    </tr>
    <tr>
      <th>32</th>
      <td>229</td>
      <td>59</td>
      <td>13.86</td>
    </tr>
    <tr>
      <th>33</th>
      <td>236</td>
      <td>38</td>
      <td>13.86</td>
    </tr>
    <tr>
      <th>34</th>
      <td>243</td>
      <td>17</td>
      <td>13.86</td>
    </tr>
    <tr>
      <th>35</th>
      <td>250</td>
      <td>55</td>
      <td>13.86</td>
    </tr>
    <tr>
      <th>36</th>
      <td>257</td>
      <td>34</td>
      <td>13.86</td>
    </tr>
    <tr>
      <th>37</th>
      <td>264</td>
      <td>13</td>
      <td>13.86</td>
    </tr>
    <tr>
      <th>38</th>
      <td>271</td>
      <td>51</td>
      <td>13.86</td>
    </tr>
    <tr>
      <th>39</th>
      <td>278</td>
      <td>30</td>
      <td>13.86</td>
    </tr>
    <tr>
      <th>40</th>
      <td>285</td>
      <td>9</td>
      <td>13.86</td>
    </tr>
    <tr>
      <th>41</th>
      <td>292</td>
      <td>47</td>
      <td>13.86</td>
    </tr>
    <tr>
      <th>42</th>
      <td>298</td>
      <td>17</td>
      <td>10.91</td>
    </tr>
    <tr>
      <th>43</th>
      <td>306</td>
      <td>5</td>
      <td>16.86</td>
    </tr>
    <tr>
      <th>44</th>
      <td>311</td>
      <td>28</td>
      <td>11.94</td>
    </tr>
    <tr>
      <th>45</th>
      <td>312</td>
      <td>34</td>
      <td>10.91</td>
    </tr>
    <tr>
      <th>46</th>
      <td>313</td>
      <td>43</td>
      <td>16.86</td>
    </tr>
    <tr>
      <th>47</th>
      <td>320</td>
      <td>22</td>
      <td>13.86</td>
    </tr>
    <tr>
      <th>48</th>
      <td>327</td>
      <td>1</td>
      <td>13.86</td>
    </tr>
    <tr>
      <th>49</th>
      <td>334</td>
      <td>39</td>
      <td>13.86</td>
    </tr>
    <tr>
      <th>50</th>
      <td>341</td>
      <td>18</td>
      <td>13.86</td>
    </tr>
    <tr>
      <th>51</th>
      <td>348</td>
      <td>56</td>
      <td>13.86</td>
    </tr>
    <tr>
      <th>52</th>
      <td>355</td>
      <td>35</td>
      <td>13.86</td>
    </tr>
    <tr>
      <th>53</th>
      <td>362</td>
      <td>14</td>
      <td>13.86</td>
    </tr>
    <tr>
      <th>54</th>
      <td>369</td>
      <td>52</td>
      <td>13.86</td>
    </tr>
    <tr>
      <th>55</th>
      <td>376</td>
      <td>31</td>
      <td>13.86</td>
    </tr>
    <tr>
      <th>56</th>
      <td>383</td>
      <td>10</td>
      <td>13.86</td>
    </tr>
    <tr>
      <th>57</th>
      <td>390</td>
      <td>48</td>
      <td>13.86</td>
    </tr>
    <tr>
      <th>58</th>
      <td>397</td>
      <td>27</td>
      <td>13.86</td>
    </tr>
    <tr>
      <th>59</th>
      <td>411</td>
      <td>44</td>
      <td>13.86</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="funciones-de-agregacion">
<h2>FUNCIONES DE AGREGACION<a class="headerlink" href="#funciones-de-agregacion" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">COUNT(</span> <span class="pre">name</span> <span class="pre">)</span>&#160; <span class="pre">AS</span> <span class="pre">othername</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">COUNT(DISTINCT</span> <span class="pre">name)</span> <span class="pre">AS</span> <span class="pre">othername</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SUM(</span> <span class="pre">name)</span> <span class="pre">AS</span> <span class="pre">othername</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">AVG(name)</span> <span class="pre">AS</span> <span class="pre">othername</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">MIN(name)</span> <span class="pre">AS</span> <span class="pre">othername</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">MAX(name)</span> <span class="pre">AS</span> <span class="pre">othername</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Contar el total de clientes en la tabla Customer</span>
<span class="n">query</span><span class="o">=</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">SELECT COUNT(CustomerId) AS TotalClientes</span>
<span class="s1">FROM Customer;</span>
<span class="s1">&#39;&#39;&#39;</span>

<span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TotalClientes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>59</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Contar el total de pa√≠ses  en la tabla Customer</span>
<span class="n">query</span><span class="o">=</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">SELECT COUNT(Country) AS TotalPaises</span>
<span class="s1">FROM Customer;</span>
<span class="s1">&#39;&#39;&#39;</span>

<span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TotalPaises</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>59</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Contar el total de pa√≠ses distintos/unicos en la tabla Customer </span>
<span class="n">query</span><span class="o">=</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">SELECT COUNT(DISTINCT Country) AS TotalPaises</span>
<span class="s1">FROM Customer;</span>
<span class="s1">&#39;&#39;&#39;</span>

<span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TotalPaises</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>24</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Sumar el total de ventas en la tabla Invoice</span>
<span class="n">query</span><span class="o">=</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">SELECT SUM(Total) AS TotalVentas</span>
<span class="s1">FROM Invoice;</span>
<span class="s1">&#39;&#39;&#39;</span>

<span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TotalVentas</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2328.6</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calcular el promedio de ventas entre 2009 y 2011</span>
<span class="n">query</span><span class="o">=</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">SELECT AVG(Total) AS PromedioVentas</span>
<span class="s1">FROM Invoice</span>
<span class="s1">WHERE InvoiceDate BETWEEN &#39;2009-01-01&#39; AND &#39;2011-12-31&#39;;</span>
<span class="s1">&#39;&#39;&#39;</span>

<span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PromedioVentas</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>None</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Encontrar la factura m√≠nima y m√°xima en la tabla Invoice</span>
<span class="n">query</span><span class="o">=</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">SELECT MIN(Total) AS FacturaMinima,</span>
<span class="s1">       MAX(Total) AS FacturaMaxima</span>
<span class="s1">FROM Invoice;</span>
<span class="s1">&#39;&#39;&#39;</span>

<span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>FacturaMinima</th>
      <th>FacturaMaxima</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.99</td>
      <td>25.86</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calcular la diferencia entre la factura m√°xima y m√≠nima en Canad√°</span>
<span class="n">query</span><span class="o">=</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">SELECT</span>
<span class="s1">    MAX(Total) - MIN(Total) AS DiferenciaTotal</span>
<span class="s1">FROM</span>
<span class="s1">    Invoice</span>
<span class="s1">WHERE</span>
<span class="s1">    BillingCountry = &#39;Canada&#39;;</span>

<span class="s1">&#39;&#39;&#39;</span>

<span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DiferenciaTotal</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>12.87</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="group-by-order-by">
<h2>GROUP BY - ORDER BY<a class="headerlink" href="#group-by-order-by" title="Link to this heading">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">GROUP</span> <span class="pre">BY</span></code> agrupa filas que tienen valores iguales en una o varias columnas, para que puedas aplicar funciones de agregaci√≥n (como <code class="docutils literal notranslate"><span class="pre">COUNT()</span></code>, <code class="docutils literal notranslate"><span class="pre">SUM()</span></code>, <code class="docutils literal notranslate"><span class="pre">AVG()</span></code>, etc.) a cada grupo.</p>
<p><strong>‚ö†Ô∏è Reglas importantes</strong></p>
<ul class="simple">
<li><p>Todas las columnas en el SELECT deben estar:</p></li>
<li><p>O bien en el GROUP BY</p></li>
<li><p>O dentro de una funci√≥n de agregaci√≥n (COUNT, SUM, etc.)</p></li>
</ul>
<p>Si no se cumple lo anterior, obtendr√°s un error de SQL.‚ö†Ô∏è</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Promedio de duraci√≥n por g√©nero y promedio de precio por unidad</span>

<span class="n">query</span><span class="o">=</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">        SELECT</span>

<span class="s1">        GenreId AS IDGenero,</span>
<span class="s1">        AVG(Milliseconds)/1000 AS Duracion_Promedio,</span>
<span class="s1">        AVG(UnitPrice) AS Precio_Promedio</span>


<span class="s1">        FROM Track</span>


<span class="s1">        GROUP BY GenreId</span>

<span class="s1">        ORDER BY Precio_Promedio DESC</span>
<span class="s1">        &#39;&#39;&#39;</span>

<span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">query</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>IDGenero</th>
      <th>Duracion_Promedio</th>
      <th>Precio_Promedio</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>18</td>
      <td>2625.549077</td>
      <td>1.99</td>
    </tr>
    <tr>
      <th>1</th>
      <td>19</td>
      <td>2145.041022</td>
      <td>1.99</td>
    </tr>
    <tr>
      <th>2</th>
      <td>20</td>
      <td>2911.783038</td>
      <td>1.99</td>
    </tr>
    <tr>
      <th>3</th>
      <td>21</td>
      <td>2575.283781</td>
      <td>1.99</td>
    </tr>
    <tr>
      <th>4</th>
      <td>22</td>
      <td>1585.263706</td>
      <td>1.99</td>
    </tr>
    <tr>
      <th>5</th>
      <td>7</td>
      <td>232.859263</td>
      <td>0.99</td>
    </tr>
    <tr>
      <th>6</th>
      <td>24</td>
      <td>293.867568</td>
      <td>0.99</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1</td>
      <td>283.910043</td>
      <td>0.99</td>
    </tr>
    <tr>
      <th>8</th>
      <td>3</td>
      <td>309.749444</td>
      <td>0.99</td>
    </tr>
    <tr>
      <th>9</th>
      <td>4</td>
      <td>234.353849</td>
      <td>0.99</td>
    </tr>
    <tr>
      <th>10</th>
      <td>6</td>
      <td>270.359778</td>
      <td>0.99</td>
    </tr>
    <tr>
      <th>11</th>
      <td>8</td>
      <td>247.177759</td>
      <td>0.99</td>
    </tr>
    <tr>
      <th>12</th>
      <td>10</td>
      <td>244.370884</td>
      <td>0.99</td>
    </tr>
    <tr>
      <th>13</th>
      <td>11</td>
      <td>219.590000</td>
      <td>0.99</td>
    </tr>
    <tr>
      <th>14</th>
      <td>13</td>
      <td>297.452929</td>
      <td>0.99</td>
    </tr>
    <tr>
      <th>15</th>
      <td>14</td>
      <td>220.066852</td>
      <td>0.99</td>
    </tr>
    <tr>
      <th>16</th>
      <td>15</td>
      <td>302.985800</td>
      <td>0.99</td>
    </tr>
    <tr>
      <th>17</th>
      <td>16</td>
      <td>224.923821</td>
      <td>0.99</td>
    </tr>
    <tr>
      <th>18</th>
      <td>17</td>
      <td>178.176286</td>
      <td>0.99</td>
    </tr>
    <tr>
      <th>19</th>
      <td>23</td>
      <td>264.058525</td>
      <td>0.99</td>
    </tr>
    <tr>
      <th>20</th>
      <td>25</td>
      <td>174.813000</td>
      <td>0.99</td>
    </tr>
    <tr>
      <th>21</th>
      <td>2</td>
      <td>291.755377</td>
      <td>0.99</td>
    </tr>
    <tr>
      <th>22</th>
      <td>5</td>
      <td>134.643500</td>
      <td>0.99</td>
    </tr>
    <tr>
      <th>23</th>
      <td>9</td>
      <td>229.034104</td>
      <td>0.99</td>
    </tr>
    <tr>
      <th>24</th>
      <td>12</td>
      <td>189.164208</td>
      <td>0.99</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Cantidad de canciones por G√©nero y promedio en segundos</span>

<span class="n">query</span><span class="o">=</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">SELECT</span>

<span class="s1">GenreId AS IDGenero,</span>
<span class="s1">Composer AS Compositor,</span>
<span class="s1">COUNT(*) AS total_canciones,</span>
<span class="s1">AVG(Milliseconds)/1000 AS Duracion_Promedio</span>

<span class="s1">FROM Track</span>

<span class="s1">WHERE</span>
<span class="s1">Composer IS NOT NULL</span>

<span class="s1">GROUP BY</span>

<span class="s1">GenreId,</span>
<span class="s1">Composer</span>

<span class="s1">ORDER BY</span>

<span class="s1">total_canciones DESC,</span>
<span class="s1">Compositor ASC</span>
<span class="s1">&#39;&#39;&#39;</span>


<span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">query</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>IDGenero</th>
      <th>Compositor</th>
      <th>total_canciones</th>
      <th>Duracion_Promedio</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>U2</td>
      <td>44</td>
      <td>256.177636</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>Steve Harris</td>
      <td>36</td>
      <td>344.181694</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>Jagger/Richards</td>
      <td>35</td>
      <td>247.633657</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Billy Corgan</td>
      <td>31</td>
      <td>255.243645</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>Kurt Cobain</td>
      <td>26</td>
      <td>193.482346</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>891</th>
      <td>1</td>
      <td>ian paice/jon lord</td>
      <td>1</td>
      <td>356.963000</td>
    </tr>
    <tr>
      <th>892</th>
      <td>12</td>
      <td>jim croce</td>
      <td>1</td>
      <td>169.900000</td>
    </tr>
    <tr>
      <th>893</th>
      <td>12</td>
      <td>lorenz hart/richard rodgers</td>
      <td>1</td>
      <td>184.111000</td>
    </tr>
    <tr>
      <th>894</th>
      <td>12</td>
      <td>orlando murden/ronald miller</td>
      <td>1</td>
      <td>171.154000</td>
    </tr>
    <tr>
      <th>895</th>
      <td>12</td>
      <td>rod mckuen</td>
      <td>1</td>
      <td>203.964000</td>
    </tr>
  </tbody>
</table>
<p>896 rows √ó 4 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Cantidad de canciones por G√©nero y promedio en segundos para autores desconocidos</span>

<span class="n">query</span><span class="o">=</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">SELECT</span>

<span class="s1">GenreId AS IDGenero,</span>
<span class="s1">Composer AS Compositor,</span>
<span class="s1">COUNT(*) AS total_canciones,</span>
<span class="s1">AVG(Milliseconds)/1000 AS Duracion_Promedio</span>

<span class="s1">FROM Track</span>

<span class="s1">WHERE</span>
<span class="s1">Composer IS NULL</span>

<span class="s1">GROUP BY</span>

<span class="s1">GenreId,</span>
<span class="s1">Composer</span>

<span class="s1">ORDER BY</span>

<span class="s1">total_canciones DESC,</span>
<span class="s1">Compositor ASC</span>
<span class="s1">&#39;&#39;&#39;</span>


<span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">query</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>IDGenero</th>
      <th>Compositor</th>
      <th>total_canciones</th>
      <th>Duracion_Promedio</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>7</td>
      <td>None</td>
      <td>309</td>
      <td>236.063628</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>None</td>
      <td>167</td>
      <td>300.341497</td>
    </tr>
    <tr>
      <th>2</th>
      <td>19</td>
      <td>None</td>
      <td>93</td>
      <td>2145.041022</td>
    </tr>
    <tr>
      <th>3</th>
      <td>21</td>
      <td>None</td>
      <td>64</td>
      <td>2575.283781</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2</td>
      <td>None</td>
      <td>51</td>
      <td>234.459255</td>
    </tr>
    <tr>
      <th>5</th>
      <td>3</td>
      <td>None</td>
      <td>44</td>
      <td>298.544614</td>
    </tr>
    <tr>
      <th>6</th>
      <td>4</td>
      <td>None</td>
      <td>31</td>
      <td>222.648645</td>
    </tr>
    <tr>
      <th>7</th>
      <td>8</td>
      <td>None</td>
      <td>27</td>
      <td>257.777741</td>
    </tr>
    <tr>
      <th>8</th>
      <td>9</td>
      <td>None</td>
      <td>26</td>
      <td>227.256077</td>
    </tr>
    <tr>
      <th>9</th>
      <td>20</td>
      <td>None</td>
      <td>26</td>
      <td>2911.783038</td>
    </tr>
    <tr>
      <th>10</th>
      <td>23</td>
      <td>None</td>
      <td>26</td>
      <td>279.613154</td>
    </tr>
    <tr>
      <th>11</th>
      <td>15</td>
      <td>None</td>
      <td>17</td>
      <td>260.520176</td>
    </tr>
    <tr>
      <th>12</th>
      <td>22</td>
      <td>None</td>
      <td>17</td>
      <td>1585.263706</td>
    </tr>
    <tr>
      <th>13</th>
      <td>10</td>
      <td>None</td>
      <td>16</td>
      <td>274.587312</td>
    </tr>
    <tr>
      <th>14</th>
      <td>17</td>
      <td>None</td>
      <td>16</td>
      <td>185.444375</td>
    </tr>
    <tr>
      <th>15</th>
      <td>11</td>
      <td>None</td>
      <td>15</td>
      <td>219.590000</td>
    </tr>
    <tr>
      <th>16</th>
      <td>18</td>
      <td>None</td>
      <td>13</td>
      <td>2625.549077</td>
    </tr>
    <tr>
      <th>17</th>
      <td>14</td>
      <td>None</td>
      <td>10</td>
      <td>201.638400</td>
    </tr>
    <tr>
      <th>18</th>
      <td>24</td>
      <td>None</td>
      <td>6</td>
      <td>227.417333</td>
    </tr>
    <tr>
      <th>19</th>
      <td>13</td>
      <td>None</td>
      <td>3</td>
      <td>234.753333</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>¬øCu√°l es el total de canciones cuyo autor es desconocido?</strong></p>
<hr class="docutils" />
<p>No se usa GROUP BY porque queremos una sola fila con la suma total de todas las canciones.</p>
<p>No hay necesidad de agrupar: el resultado es global.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Aqui no se requiere Group by</span>

<span class="n">query</span><span class="o">=</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">SELECT</span>
<span class="s1">COUNT(TrackId) AS total_canciones_desconocidas</span>

<span class="s1">FROM Track</span>

<span class="s1">WHERE</span>
<span class="s1">Composer IS NULL</span>
<span class="s1">&#39;&#39;&#39;</span>

<span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">query</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>total_canciones_desconocidas</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>977</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="where-vs-having">
<h3>WHERE VS  HAVING<a class="headerlink" href="#where-vs-having" title="Link to this heading">#</a></h3>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p><code class="docutils literal notranslate"><span class="pre">WHERE</span></code></p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">HAVING</span></code></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Filtra <strong>antes</strong> de agrupar</p></td>
<td><p>Filtra <strong>despu√©s</strong> de agrupar</p></td>
</tr>
<tr class="row-odd"><td><p>Se usa con columnas</p></td>
<td><p>Se usa con funciones de agregaci√≥n</p></td>
</tr>
<tr class="row-even"><td><p>Afecta qu√© filas se agrupan</p></td>
<td><p>Afecta qu√© grupos se muestran</p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>üß† Pensamiento clave:</strong></p>
<blockquote>
<div><ul class="simple">
<li><p>Usa <strong>WHERE</strong> para filtrar filas individuales.</p></li>
</ul>
</div></blockquote>
<blockquote>
<div><ul class="simple">
<li><p>Usa <strong>HAVING</strong> para filtrar grupos despu√©s de aplicar GROUP BY.</p></li>
</ul>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Canciones de m√°s de 3 minutos</span>

<span class="n">query</span><span class="o">=</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">SELECT Name, Milliseconds</span>
<span class="s1">FROM Track</span>
<span class="s1">WHERE Milliseconds &gt; 180000;</span>

<span class="s1">&#39;&#39;&#39;</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">query</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Milliseconds</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>For Those About To Rock (We Salute You)</td>
      <td>343719</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Balls to the Wall</td>
      <td>342562</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Fast As a Shark</td>
      <td>230619</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Restless and Wild</td>
      <td>252051</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Princess of the Dawn</td>
      <td>375418</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3018</th>
      <td>Erlkonig, D.328</td>
      <td>261849</td>
    </tr>
    <tr>
      <th>3019</th>
      <td>Concerto for Violin, Strings and Continuo in G...</td>
      <td>493573</td>
    </tr>
    <tr>
      <th>3020</th>
      <td>Pini Di Roma (Pinien Von Rom) \ I Pini Della V...</td>
      <td>286741</td>
    </tr>
    <tr>
      <th>3021</th>
      <td>Quintet for Horn, Violin, 2 Violas, and Cello ...</td>
      <td>221331</td>
    </tr>
    <tr>
      <th>3022</th>
      <td>Koyaanisqatsi</td>
      <td>206005</td>
    </tr>
  </tbody>
</table>
<p>3023 rows √ó 2 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Facturas mayores a $10</span>
<span class="n">query</span><span class="o">=</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">SELECT InvoiceId, Total</span>
<span class="s1">FROM invoice</span>
<span class="s1">WHERE Total &gt; 10</span>

<span class="s1">ORDER BY Total DESC</span>
<span class="s1">LIMIT 15</span>
<span class="s1">&#39;&#39;&#39;</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">query</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>InvoiceId</th>
      <th>Total</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>404</td>
      <td>25.86</td>
    </tr>
    <tr>
      <th>1</th>
      <td>299</td>
      <td>23.86</td>
    </tr>
    <tr>
      <th>2</th>
      <td>96</td>
      <td>21.86</td>
    </tr>
    <tr>
      <th>3</th>
      <td>194</td>
      <td>21.86</td>
    </tr>
    <tr>
      <th>4</th>
      <td>89</td>
      <td>18.86</td>
    </tr>
    <tr>
      <th>5</th>
      <td>201</td>
      <td>18.86</td>
    </tr>
    <tr>
      <th>6</th>
      <td>88</td>
      <td>17.91</td>
    </tr>
    <tr>
      <th>7</th>
      <td>306</td>
      <td>16.86</td>
    </tr>
    <tr>
      <th>8</th>
      <td>313</td>
      <td>16.86</td>
    </tr>
    <tr>
      <th>9</th>
      <td>103</td>
      <td>15.86</td>
    </tr>
    <tr>
      <th>10</th>
      <td>208</td>
      <td>15.86</td>
    </tr>
    <tr>
      <th>11</th>
      <td>193</td>
      <td>14.91</td>
    </tr>
    <tr>
      <th>12</th>
      <td>5</td>
      <td>13.86</td>
    </tr>
    <tr>
      <th>13</th>
      <td>12</td>
      <td>13.86</td>
    </tr>
    <tr>
      <th>14</th>
      <td>19</td>
      <td>13.86</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#G√©neros con m√°s de 100 canciones</span>

<span class="n">query</span><span class="o">=</span><span class="s1">&#39;&#39;&#39;</span>

<span class="s1">SELECT GenreId,</span>
<span class="s1">COUNT(*) AS total</span>

<span class="s1">FROM Track</span>

<span class="s1">GROUP BY GenreId</span>

<span class="s1">HAVING COUNT(*) &gt; 50</span>

<span class="s1">ORDER BY total DESC</span>
<span class="s1">LIMIT 5</span>

<span class="s1">&#39;&#39;&#39;</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">query</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>GenreId</th>
      <th>total</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1297</td>
    </tr>
    <tr>
      <th>1</th>
      <td>7</td>
      <td>579</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>374</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>332</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2</td>
      <td>130</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Clientes que han gastado m√°s de $50</span>

<span class="n">query</span><span class="o">=</span><span class="s1">&#39;&#39;&#39;</span>

<span class="s1">SELECT CustomerId,</span>
<span class="s1">SUM(Total) AS total_gastado</span>
<span class="s1">FROM Invoice</span>
<span class="s1">GROUP BY CustomerId</span>
<span class="s1">HAVING total_gastado &gt; 12</span>
<span class="s1">ORDER BY total_gastado DESC</span>
<span class="s1">LIMIT 8</span>

<span class="s1">&#39;&#39;&#39;</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">query</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CustomerId</th>
      <th>total_gastado</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>6</td>
      <td>49.62</td>
    </tr>
    <tr>
      <th>1</th>
      <td>26</td>
      <td>47.62</td>
    </tr>
    <tr>
      <th>2</th>
      <td>57</td>
      <td>46.62</td>
    </tr>
    <tr>
      <th>3</th>
      <td>45</td>
      <td>45.62</td>
    </tr>
    <tr>
      <th>4</th>
      <td>46</td>
      <td>45.62</td>
    </tr>
    <tr>
      <th>5</th>
      <td>24</td>
      <td>43.62</td>
    </tr>
    <tr>
      <th>6</th>
      <td>28</td>
      <td>43.62</td>
    </tr>
    <tr>
      <th>7</th>
      <td>37</td>
      <td>43.62</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="case-when">
<h2>CASE - WHEN<a class="headerlink" href="#case-when" title="Link to this heading">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">CASE</span> <span class="pre">WHEN</span></code> te permite hacer condiciones dentro de una consulta SQL, como un <code class="docutils literal notranslate"><span class="pre">if</span></code>‚Ä¶<code class="docutils literal notranslate"><span class="pre">else</span></code>.</p>
<blockquote>
<div><p>Sirve para crear nuevas columnas calculadas o categorizadas seg√∫n reglas l√≥gicas.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Clasificar duraci√≥n de canciones</span>

<span class="n">query</span><span class="o">=</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">SELECT</span>
<span class="s1">  Name,</span>
<span class="s1">  Milliseconds,</span>
<span class="s1">  CASE</span>
<span class="s1">    WHEN Milliseconds &lt; 180000 THEN &#39;Corta&#39;</span>
<span class="s1">    WHEN Milliseconds BETWEEN 180000 AND 300000 THEN &#39;Media&#39;</span>
<span class="s1">    ELSE &#39;Larga&#39;</span>
<span class="s1">  END AS duracion_clasificada</span>
<span class="s1">FROM Track</span>
<span class="s1">ORDER BY duracion_clasificada</span>
<span class="s1">&#39;&#39;&#39;</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">query</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Milliseconds</th>
      <th>duracion_clasificada</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Right Through You</td>
      <td>176117</td>
      <td>Corta</td>
    </tr>
    <tr>
      <th>1</th>
      <td>We Die Young</td>
      <td>152084</td>
      <td>Corta</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Samba De Uma Nota S√≥ (One Note Samba)</td>
      <td>137273</td>
      <td>Corta</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Por Causa De Voc√™</td>
      <td>169900</td>
      <td>Corta</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Fotografia</td>
      <td>129227</td>
      <td>Corta</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3498</th>
      <td>24 Caprices, Op. 1, No. 24, for Solo Violin, i...</td>
      <td>265541</td>
      <td>Media</td>
    </tr>
    <tr>
      <th>3499</th>
      <td>Erlkonig, D.328</td>
      <td>261849</td>
      <td>Media</td>
    </tr>
    <tr>
      <th>3500</th>
      <td>Pini Di Roma (Pinien Von Rom) \ I Pini Della V...</td>
      <td>286741</td>
      <td>Media</td>
    </tr>
    <tr>
      <th>3501</th>
      <td>Quintet for Horn, Violin, 2 Violas, and Cello ...</td>
      <td>221331</td>
      <td>Media</td>
    </tr>
    <tr>
      <th>3502</th>
      <td>Koyaanisqatsi</td>
      <td>206005</td>
      <td>Media</td>
    </tr>
  </tbody>
</table>
<p>3503 rows √ó 3 columns</p>
</div></div></div>
</div>
<section id="ejercicio-3">
<h3>üß© Ejercicio 3<a class="headerlink" href="#ejercicio-3" title="Link to this heading">#</a></h3>
<p>Crea una consulta que clasifique los g√©neros musicales por n√∫mero de canciones:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Pocos</span></code> si tienen menos de 50 canciones</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Normales</span></code> si tienen entre 50 y 100</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Populares</span></code> si tienen m√°s de 100</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query</span><span class="o">=</span><span class="s1">&#39;&#39;&#39;</span>

<span class="s1">SELECT</span>
<span class="s1">GenreId,</span>
<span class="s1">COUNT(GenreID) AS total_canciones,</span>
<span class="s1">CASE</span>
<span class="s1">  WHEN COUNT(GenreID) &lt; 50 THEN &#39;Pocos&#39;</span>
<span class="s1">  WHEN COUNT(GenreID) BETWEEN 50 AND 100 THEN &#39;Normales&#39;</span>
<span class="s1">  ELSE &#39;Populares&#39;</span>
<span class="s1">END AS clasificacion</span>
<span class="s1">FROM Track</span>

<span class="s1">GROUP BY GenreId</span>

<span class="s1">&#39;&#39;&#39;</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">query</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>GenreId</th>
      <th>total_canciones</th>
      <th>clasificacion</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1297</td>
      <td>Populares</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>130</td>
      <td>Populares</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>374</td>
      <td>Populares</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>332</td>
      <td>Populares</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>12</td>
      <td>Pocos</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
      <td>81</td>
      <td>Normales</td>
    </tr>
    <tr>
      <th>6</th>
      <td>7</td>
      <td>579</td>
      <td>Populares</td>
    </tr>
    <tr>
      <th>7</th>
      <td>8</td>
      <td>58</td>
      <td>Normales</td>
    </tr>
    <tr>
      <th>8</th>
      <td>9</td>
      <td>48</td>
      <td>Pocos</td>
    </tr>
    <tr>
      <th>9</th>
      <td>10</td>
      <td>43</td>
      <td>Pocos</td>
    </tr>
    <tr>
      <th>10</th>
      <td>11</td>
      <td>15</td>
      <td>Pocos</td>
    </tr>
    <tr>
      <th>11</th>
      <td>12</td>
      <td>24</td>
      <td>Pocos</td>
    </tr>
    <tr>
      <th>12</th>
      <td>13</td>
      <td>28</td>
      <td>Pocos</td>
    </tr>
    <tr>
      <th>13</th>
      <td>14</td>
      <td>61</td>
      <td>Normales</td>
    </tr>
    <tr>
      <th>14</th>
      <td>15</td>
      <td>30</td>
      <td>Pocos</td>
    </tr>
    <tr>
      <th>15</th>
      <td>16</td>
      <td>28</td>
      <td>Pocos</td>
    </tr>
    <tr>
      <th>16</th>
      <td>17</td>
      <td>35</td>
      <td>Pocos</td>
    </tr>
    <tr>
      <th>17</th>
      <td>18</td>
      <td>13</td>
      <td>Pocos</td>
    </tr>
    <tr>
      <th>18</th>
      <td>19</td>
      <td>93</td>
      <td>Normales</td>
    </tr>
    <tr>
      <th>19</th>
      <td>20</td>
      <td>26</td>
      <td>Pocos</td>
    </tr>
    <tr>
      <th>20</th>
      <td>21</td>
      <td>64</td>
      <td>Normales</td>
    </tr>
    <tr>
      <th>21</th>
      <td>22</td>
      <td>17</td>
      <td>Pocos</td>
    </tr>
    <tr>
      <th>22</th>
      <td>23</td>
      <td>40</td>
      <td>Pocos</td>
    </tr>
    <tr>
      <th>23</th>
      <td>24</td>
      <td>74</td>
      <td>Normales</td>
    </tr>
    <tr>
      <th>24</th>
      <td>25</td>
      <td>1</td>
      <td>Pocos</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>¬øCu√°les son los pa√≠ses con m√°s de 5 facturas emitidas, ordenalos de mayor a menor?</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query</span><span class="o">=</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">SELECT</span>
<span class="s1">BillingCountry,</span>
<span class="s1">COUNT(*) AS total_facturas</span>

<span class="s1">FROM invoice</span>

<span class="s1">GROUP BY BillingCountry</span>

<span class="s1">HAVING COUNT(*) &gt; 5</span>
<span class="s1">ORDER BY total_facturas DESC</span>
<span class="s1">&#39;&#39;&#39;</span>

<span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">query</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>BillingCountry</th>
      <th>total_facturas</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>USA</td>
      <td>91</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Canada</td>
      <td>56</td>
    </tr>
    <tr>
      <th>2</th>
      <td>France</td>
      <td>35</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Brazil</td>
      <td>35</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Germany</td>
      <td>28</td>
    </tr>
    <tr>
      <th>5</th>
      <td>United Kingdom</td>
      <td>21</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Portugal</td>
      <td>14</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Czech Republic</td>
      <td>14</td>
    </tr>
    <tr>
      <th>8</th>
      <td>India</td>
      <td>13</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Sweden</td>
      <td>7</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Spain</td>
      <td>7</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Poland</td>
      <td>7</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Norway</td>
      <td>7</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Netherlands</td>
      <td>7</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Italy</td>
      <td>7</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Ireland</td>
      <td>7</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Hungary</td>
      <td>7</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Finland</td>
      <td>7</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Denmark</td>
      <td>7</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Chile</td>
      <td>7</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Belgium</td>
      <td>7</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Austria</td>
      <td>7</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Australia</td>
      <td>7</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Argentina</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>Clasifica a los empleados por su cargo</strong>
Muestra los empleados, su cargo (Title) y una etiqueta basada en su cargo:</p>
<ul class="simple">
<li><p>‚ÄúSoporte‚Äù si es Support Agent</p></li>
<li><p>‚ÄúVentas‚Äù si contiene la palabra Sales</p></li>
<li><p>‚ÄúOtro‚Äù para los dem√°s</p></li>
</ul>
<p>Solo muestra aquellos cuyo t√≠tulo no sea ‚ÄúIT Manager‚Äù, ordenados alfab√©ticamente por la etiqueta.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query</span><span class="o">=</span><span class="s1">&#39;&#39;&#39;</span>

<span class="s1">SELECT</span>
<span class="s1">  FirstName AS Nombre,</span>
<span class="s1">  LastName AS Apellido,</span>
<span class="s1">  Title AS Cargo,</span>

<span class="s1">  CASE</span>
<span class="s1">    WHEN Title = &#39;Support Agent&#39; THEN &#39;Soporte&#39;</span>
<span class="s1">    WHEN Title LIKE &#39;%Sales%&#39; THEN &#39;Ventas&#39;</span>
<span class="s1">    ELSE &#39;Otro&#39;</span>
<span class="s1">  END AS rol_etiqueta</span>

<span class="s1">FROM employee</span>

<span class="s1">WHERE Title != &#39;IT Manager&#39;</span>

<span class="s1">ORDER BY rol_etiqueta</span>

<span class="s1">&#39;&#39;&#39;</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">query</span><span class="p">,</span><span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Nombre</th>
      <th>Apellido</th>
      <th>Cargo</th>
      <th>rol_etiqueta</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Andrew</td>
      <td>Adams</td>
      <td>General Manager</td>
      <td>Otro</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Robert</td>
      <td>King</td>
      <td>IT Staff</td>
      <td>Otro</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Laura</td>
      <td>Callahan</td>
      <td>IT Staff</td>
      <td>Otro</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Nancy</td>
      <td>Edwards</td>
      <td>Sales Manager</td>
      <td>Ventas</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Jane</td>
      <td>Peacock</td>
      <td>Sales Support Agent</td>
      <td>Ventas</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Margaret</td>
      <td>Park</td>
      <td>Sales Support Agent</td>
      <td>Ventas</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Steve</td>
      <td>Johnson</td>
      <td>Sales Support Agent</td>
      <td>Ventas</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="tipos-de-datos-conversiones">
<h2>TIPOS DE DATOS: CONVERSIONES<a class="headerlink" href="#tipos-de-datos-conversiones" title="Link to this heading">#</a></h2>
<p>Los m√°s comunes son:</p>
<ul class="simple">
<li><p>INTEGER para n√∫meros enteros,</p></li>
<li><p>REAL o FLOAT para n√∫meros decimales</p></li>
<li><p>TEXT para cadenas de caracteres (como nombres o descripciones)</p></li>
<li><p>DATE para fechas.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query</span><span class="o">=</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">SELECT CAST(&#39;123&#39; AS INTEGER) AS numero;</span>
<span class="s1">&#39;&#39;&#39;</span>

<span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>numero</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>123</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query</span><span class="o">=</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">SELECT CAST(456 AS TEXT) AS texto;</span>
<span class="s1">&#39;&#39;&#39;</span>

<span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>texto</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>456</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query</span><span class="o">=</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">SELECT DATE(&#39;2023-06-26&#39;) AS fecha_valida;</span>
<span class="s1">&#39;&#39;&#39;</span>

<span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fecha_valida</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2023-06-26</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<hr class="docutils" />
<section id="cierre">
<h2>Cierre<a class="headerlink" href="#cierre" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Resumen de aprendizajes clave:</p></li>
<li><p>Navegamos un esquema relacional e identificamos PK/FK.</p></li>
<li><p>Practicamos <code class="docutils literal notranslate"><span class="pre">SELECT</span></code>, <code class="docutils literal notranslate"><span class="pre">WHERE</span></code>, <code class="docutils literal notranslate"><span class="pre">ORDER</span> <span class="pre">BY</span></code> y <code class="docutils literal notranslate"><span class="pre">GROUP</span> <span class="pre">BY</span></code>, junto con agregaciones (<code class="docutils literal notranslate"><span class="pre">COUNT</span></code>, <code class="docutils literal notranslate"><span class="pre">SUM</span></code>, <code class="docutils literal notranslate"><span class="pre">AVG</span></code>)</p></li>
<li><p>Aplicamos filtros con <code class="docutils literal notranslate"><span class="pre">HAVING</span></code> y gestionamos resultados con <code class="docutils literal notranslate"><span class="pre">LIMIT</span></code>.</p></li>
<li><p>Q&amp;A y pr√≥ximos pasos.</p></li>
</ul>
</section>
<section id="sesion-practica">
<h2>Sesi√≥n Pr√°ctica<a class="headerlink" href="#sesion-practica" title="Link to this heading">#</a></h2>
</section>
<section id="taller-practico-analitica-de-negocio-con-sql-db-chinook">
<h2>üß™ Taller pr√°ctico: Anal√≠tica de negocio con SQL (DB Chinook)<a class="headerlink" href="#taller-practico-analitica-de-negocio-con-sql-db-chinook" title="Link to this heading">#</a></h2>
<p>Objetivo: practicar <code class="docutils literal notranslate"><span class="pre">GROUP</span> <span class="pre">BY</span></code>, funciones de agregaci√≥n, <code class="docutils literal notranslate"><span class="pre">HAVING</span></code>, <code class="docutils literal notranslate"><span class="pre">BETWEEN</span></code>,  <code class="docutils literal notranslate"><span class="pre">CASE</span> <span class="pre">WHEN</span></code>**</p>
<p>Tablas que vamos a usar:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">invoices</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">invoice_items</span></code> (o <code class="docutils literal notranslate"><span class="pre">InvoiceLine</span></code>, seg√∫n tu versi√≥n)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">customers</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tracks</span></code></p></li>
</ul>
<hr class="docutils" />
<section id="volumen-de-facturas-por-pais">
<h3>1Ô∏è‚É£ Volumen de facturas por pa√≠s<a class="headerlink" href="#volumen-de-facturas-por-pais" title="Link to this heading">#</a></h3>
<p><strong>Pregunta de negocio:</strong><br />
¬øQu√© pa√≠ses generan m√°s facturas en la tienda?</p>
<p><strong>Instrucciones:</strong></p>
<ul class="simple">
<li><p>Usa la tabla <code class="docutils literal notranslate"><span class="pre">invoices</span></code>.</p></li>
<li><p>Cuenta cu√°ntas facturas hay por <code class="docutils literal notranslate"><span class="pre">BillingCountry</span></code>.</p></li>
<li><p>Ordena de mayor a menor n√∫mero de facturas.</p></li>
</ul>
</section>
<section id="ingreso-total-por-pais">
<h3>2Ô∏è‚É£ Ingreso total por pa√≠s<a class="headerlink" href="#ingreso-total-por-pais" title="Link to this heading">#</a></h3>
<p>Pregunta: ¬øQu√© pa√≠ses generan m√°s ingresos totales?</p>
</section>
<section id="ticket-promedio-por-pais">
<h3>3Ô∏è‚É£ Ticket promedio por pa√≠s<a class="headerlink" href="#ticket-promedio-por-pais" title="Link to this heading">#</a></h3>
<p>Pregunta: ¬øQu√© pa√≠ses tienen el monto promedio m√°s alto por factura?</p>
</section>
<section id="paises-con-volumen-significativo-de-facturas">
<h3>4Ô∏è‚É£ Pa√≠ses con volumen significativo de facturas<a class="headerlink" href="#paises-con-volumen-significativo-de-facturas" title="Link to this heading">#</a></h3>
<p>Pregunta: ¬øQu√© pa√≠ses tienen m√°s de 20 facturas?</p>
</section>
<section id="ingresos-por-pais-en-un-rango-de-fechas-between">
<h3>5Ô∏è‚É£ Ingresos por pa√≠s en un rango de fechas (BETWEEN)<a class="headerlink" href="#ingresos-por-pais-en-un-rango-de-fechas-between" title="Link to this heading">#</a></h3>
<p>Pregunta: ¬øCu√°l fue el ingreso total por pa√≠s durante el a√±o 2010?</p>
</section>
<section id="numero-de-clientes-por-pais">
<h3>6Ô∏è‚É£ N√∫mero de clientes por pa√≠s<a class="headerlink" href="#numero-de-clientes-por-pais" title="Link to this heading">#</a></h3>
<p>Pregunta: ¬øQu√© pa√≠ses tienen m√°s de 10 clientes?</p>
</section>
<section id="clasificacion-de-facturas-por-monto-case-when">
<h3>7Ô∏è‚É£ Clasificaci√≥n de facturas por monto (CASE WHEN)<a class="headerlink" href="#clasificacion-de-facturas-por-monto-case-when" title="Link to this heading">#</a></h3>
<p>Pregunta: ¬øC√≥mo se distribuyen las facturas entre peque√±as, medianas y grandes?</p>
<ul class="simple">
<li><p>Peque√±a: &lt; 5</p></li>
<li><p>Mediana: BETWEEN 5 AND 15</p></li>
<li><p>Grande: &gt; 15</p></li>
</ul>
</section>
<section id="cantidad-total-de-items-vendidos-por-factura">
<h3>8Ô∏è‚É£ Cantidad total de √≠tems vendidos por factura<a class="headerlink" href="#cantidad-total-de-items-vendidos-por-factura" title="Link to this heading">#</a></h3>
<p>Pregunta: ¬øQu√© facturas tienen m√°s unidades vendidas?</p>
</section>
<section id="facturas-con-alto-volumen-de-unidades-having">
<h3>9Ô∏è‚É£ Facturas con alto volumen de unidades (HAVING)<a class="headerlink" href="#facturas-con-alto-volumen-de-unidades-having" title="Link to this heading">#</a></h3>
<p>Pregunta: ¬øQu√© facturas superan 20 unidades vendidas?</p>
</section>
<section id="duracion-total-y-promedio-por-tipo-de-medio">
<h3>üîü Duraci√≥n total y promedio por tipo de medio<a class="headerlink" href="#duracion-total-y-promedio-por-tipo-de-medio" title="Link to this heading">#</a></h3>
<p>Pregunta: ¬øQu√© tipo de medio tiene mayor duraci√≥n total de pistas?</p>
</section>
</section>
<section id="siguientes-pasos">
<h2>Siguientes Pasos<a class="headerlink" href="#siguientes-pasos" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>Pr√≥xima semana:</strong> JOINs, CTEs y subconsultas para KPIs financieros: ingresos por periodo, margen por categor√≠a y retenci√≥n.</p></li>
<li><p><strong>Participaci√≥n continua:</strong> asistir a Co-Learning y a Sprint Focus, y usar los canales de Discord para hacer preguntas.</p></li>
<li><p><strong>Recordatorios:</strong> la grabaci√≥n y recursos utilizados, se comparten al finalizar la sesi√≥n; en caso de necesitar apoyo adicional, agenda un 1:1.</p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="sp3_intro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Sprint 3: Explorar KPIs con SQL</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#semana-1">Semana 1</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#entendiendo-el-esquema-relacional">Entendiendo el esquema relacional</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ejercicio-1">üß© Ejercicio 1</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#llaves-primarias-foraneas-y-relaciones">Llaves primarias, for√°neas y relaciones</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ejercicio-2">üß© Ejercicio 2</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conectar-a-la-base-de-datos-y-explorar-tablas-con-sql-simular">Conectar a la base de datos y explorar tablas con SQL (Simular)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#buenas-practicas-para-sql-limpio">Buenas pr√°cticas para SQL limpio</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#select-from-where">SELECT - FROM - WHERE</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#funciones-de-agregacion">FUNCIONES DE AGREGACION</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#group-by-order-by">GROUP BY - ORDER BY</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#where-vs-having">WHERE VS  HAVING</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#case-when">CASE - WHEN</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ejercicio-3">üß© Ejercicio 3</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tipos-de-datos-conversiones">TIPOS DE DATOS: CONVERSIONES</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cierre">Cierre</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sesion-practica">Sesi√≥n Pr√°ctica</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#taller-practico-analitica-de-negocio-con-sql-db-chinook">üß™ Taller pr√°ctico: Anal√≠tica de negocio con SQL (DB Chinook)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#volumen-de-facturas-por-pais">1Ô∏è‚É£ Volumen de facturas por pa√≠s</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ingreso-total-por-pais">2Ô∏è‚É£ Ingreso total por pa√≠s</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ticket-promedio-por-pais">3Ô∏è‚É£ Ticket promedio por pa√≠s</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#paises-con-volumen-significativo-de-facturas">4Ô∏è‚É£ Pa√≠ses con volumen significativo de facturas</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ingresos-por-pais-en-un-rango-de-fechas-between">5Ô∏è‚É£ Ingresos por pa√≠s en un rango de fechas (BETWEEN)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#numero-de-clientes-por-pais">6Ô∏è‚É£ N√∫mero de clientes por pa√≠s</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#clasificacion-de-facturas-por-monto-case-when">7Ô∏è‚É£ Clasificaci√≥n de facturas por monto (CASE WHEN)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cantidad-total-de-items-vendidos-por-factura">8Ô∏è‚É£ Cantidad total de √≠tems vendidos por factura</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#facturas-con-alto-volumen-de-unidades-having">9Ô∏è‚É£ Facturas con alto volumen de unidades (HAVING)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#duracion-total-y-promedio-por-tipo-de-medio">üîü Duraci√≥n total y promedio por tipo de medio</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#siguientes-pasos">Siguientes Pasos</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Gina Buvoli
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      ¬© Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>